2025-04-07 13:12:26,269 - INFO - Starting Phase 1 of Wealth Management Market Opportunity Analysis
2025-04-07 13:12:26,275 - INFO - Starting: County-to-MSA crosswalk creation
2025-04-07 13:12:26,997 - WARNING -   2025-04-07 13:12:26,825 - INFO - Downloading https://www2.census.gov/programs-surveys/metro-micro/geographies/reference-files/2020/delineation-files/list1_2020.xls...
2025-04-07 13:12:26,998 - WARNING -   2025-04-07 13:12:26,951 - ERROR - Error downloading https://www2.census.gov/programs-surveys/metro-micro/geographies/reference-files/2020/delineation-files/list1_2020.xls: 403 Client Error: Forbidden for url: https://www2.census.gov/programs-surveys/metro-micro/geographies/reference-files/2020/delineation-files/list1_2020.xls
2025-04-07 13:12:26,998 - INFO - Completed: County-to-MSA crosswalk creation
2025-04-07 13:12:26,998 - WARNING - Expected at least 1 files matching cbsa_crosswalk_data_*.pkl in /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks, but found 0
2025-04-07 13:12:26,998 - ERROR - Crosswalk files not found. Exiting.
2025-04-07 13:15:07,965 - INFO - Starting Phase 1 of Wealth Management Market Opportunity Analysis
2025-04-07 13:15:07,968 - INFO - Skipping crosswalk creation as requested
2025-04-07 13:15:07,968 - INFO - Starting: County-to-MSA data aggregation
2025-04-07 13:15:08,300 - WARNING -   2025-04-07 13:15:08,276 - INFO - Starting county-to-MSA aggregation process...
2025-04-07 13:15:08,300 - WARNING -   2025-04-07 13:15:08,276 - INFO - Loading CBSA crosswalk data...
2025-04-07 13:15:08,300 - WARNING -   2025-04-07 13:15:08,276 - ERROR - No crosswalk pickle files found. Run census_cbsa_crosswalk.py first.
2025-04-07 13:15:08,300 - WARNING -   2025-04-07 13:15:08,276 - ERROR - Failed to load crosswalk data. Exiting.
2025-04-07 13:15:08,300 - INFO - Completed: County-to-MSA data aggregation
2025-04-07 13:15:08,301 - WARNING - Expected at least 1 files matching msa_combined_metrics_*.csv in /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata, but found 0
2025-04-07 13:15:08,301 - ERROR - MSA data files not found. Exiting.
2025-04-14 09:49:30,092 - INFO - Starting Phase 1 of Wealth Management Market Opportunity Analysis
2025-04-14 09:49:30,095 - INFO - Refreshing data from original sources...
2025-04-14 09:49:30,095 - INFO - Starting: BEA Regional Economic Accounts data collection
2025-04-14 09:49:41,695 - INFO -   Created directory: bea_data
2025-04-14 09:49:41,695 - INFO -   Saved available datasets to bea_data/available_datasets.json
2025-04-14 09:49:41,695 - INFO -   Saved parameters for Regional to bea_data/parameters_Regional.json
2025-04-14 09:49:41,695 - INFO -   Saved TableName values for Regional to bea_data/Regional_TableName_values.json
2025-04-14 09:49:41,695 - INFO -   Saved parameters for Regional to bea_data/parameters_Regional.json
2025-04-14 09:49:41,695 - INFO -   Created data dictionary at bea_data/data_dictionary.json
2025-04-14 09:49:41,695 - INFO -   Created human-readable data dictionary at bea_data/data_dictionary.md
2025-04-14 09:49:41,695 - INFO -   
2025-04-14 09:49:41,695 - INFO -   Collecting test data for years 2023 to 2024
2025-04-14 09:49:41,695 - INFO -   Requesting County GDP data for years 2023-2024...
2025-04-14 09:49:41,695 - INFO -   Saved raw GDP response to bea_data/raw_county_gdp_2023_2024_A.json
2025-04-14 09:49:41,695 - INFO -   Saved GDP data to bea_data/county_gdp_2023_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County GDP by Industry data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw GDP by Industry response to bea_data/raw_county_gdp_by_industry_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Requesting County Personal Income data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Personal Income response to bea_data/raw_county_personal_income_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved Personal Income data to bea_data/county_personal_income_2023_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County Population data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Population response to bea_data/raw_county_population_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved Population data to bea_data/county_population_2023_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County Per Capita Income data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Per Capita Income response to bea_data/raw_county_per_capita_income_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved Per Capita Income data to bea_data/county_per_capita_income_2023_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County Income by Industry data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Income by Industry response to bea_data/raw_county_income_by_industry_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Requesting County Compensation by Industry data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Compensation by Industry response to bea_data/raw_county_compensation_by_industry_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Requesting County Economic Profile data for years 2023-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Economic Profile response to bea_data/raw_county_economic_profile_2023_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Test data collection complete!
2025-04-14 09:49:41,696 - INFO -   
2025-04-14 09:49:41,696 - INFO -   Now collecting full 5-year data range...
2025-04-14 09:49:41,696 - INFO -   Requesting County GDP data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw GDP response to bea_data/raw_county_gdp_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved GDP data to bea_data/county_gdp_2020_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County GDP by Industry data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw GDP by Industry response to bea_data/raw_county_gdp_by_industry_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Requesting County Personal Income data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Personal Income response to bea_data/raw_county_personal_income_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved Personal Income data to bea_data/county_personal_income_2020_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County Population data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Population response to bea_data/raw_county_population_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved Population data to bea_data/county_population_2020_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County Per Capita Income data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Per Capita Income response to bea_data/raw_county_per_capita_income_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   Saved Per Capita Income data to bea_data/county_per_capita_income_2020_2024_A.csv
2025-04-14 09:49:41,696 - INFO -   Requesting County Income by Industry data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Income by Industry response to bea_data/raw_county_income_by_industry_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Requesting County Compensation by Industry data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Compensation by Industry response to bea_data/raw_county_compensation_by_industry_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Requesting County Economic Profile data for years 2020-2024...
2025-04-14 09:49:41,696 - INFO -   Saved raw Economic Profile response to bea_data/raw_county_economic_profile_2020_2024_A.json
2025-04-14 09:49:41,696 - INFO -   API Error: {'APIErrorCode': '40', 'APIErrorDescription': 'The dataset requested requires parameters that were missing from the request.', 'AdditionalDetail': {'MissingParameter': {'ParameterName': 'LineCode', 'ParameterDescription': 'Line code for a statistic or industry'}}}
2025-04-14 09:49:41,696 - INFO -   Full BEA county data collection complete!
2025-04-14 09:49:41,696 - INFO - Completed: BEA Regional Economic Accounts data collection
2025-04-14 09:49:41,696 - INFO - Starting: Census ACS data collection
2025-04-14 09:54:36,595 - INFO -   Collecting 2023 ACS 5-year data at the county level...
2025-04-14 09:54:36,595 - INFO -   Validating API key...
2025-04-14 09:54:36,595 - INFO -   API key validated successfully.
2025-04-14 09:54:36,595 - INFO -   Getting list of states...
2025-04-14 09:54:36,595 - INFO -   Found 52 states
2025-04-14 09:54:36,595 - INFO -   Collecting data for counties in Alabama (State ID: 01)...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,595 - INFO -     Added 67 counties from Alabama
2025-04-14 09:54:36,595 - INFO -   Collecting data for counties in Alaska (State ID: 02)...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,595 - INFO -     Added 30 counties from Alaska
2025-04-14 09:54:36,595 - INFO -   Collecting data for counties in Arizona (State ID: 04)...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,595 - INFO -     Added 15 counties from Arizona
2025-04-14 09:54:36,595 - INFO -   Collecting data for counties in Arkansas (State ID: 05)...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,595 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,595 - INFO -     Added 75 counties from Arkansas
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in California (State ID: 06)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 58 counties from California
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Colorado (State ID: 08)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 64 counties from Colorado
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Connecticut (State ID: 09)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 9 counties from Connecticut
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Delaware (State ID: 10)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 3 counties from Delaware
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in District of Columbia (State ID: 11)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 1 counties from District of Columbia
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Florida (State ID: 12)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 67 counties from Florida
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Georgia (State ID: 13)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 159 counties from Georgia
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Hawaii (State ID: 15)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 5 counties from Hawaii
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Idaho (State ID: 16)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 44 counties from Idaho
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Illinois (State ID: 17)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 102 counties from Illinois
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Indiana (State ID: 18)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 92 counties from Indiana
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Iowa (State ID: 19)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 99 counties from Iowa
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Kansas (State ID: 20)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 105 counties from Kansas
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Kentucky (State ID: 21)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 120 counties from Kentucky
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Louisiana (State ID: 22)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,596 - INFO -     Added 64 counties from Louisiana
2025-04-14 09:54:36,596 - INFO -   Collecting data for counties in Maine (State ID: 23)...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,596 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 16 counties from Maine
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Maryland (State ID: 24)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 24 counties from Maryland
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Massachusetts (State ID: 25)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 14 counties from Massachusetts
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Michigan (State ID: 26)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 83 counties from Michigan
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Minnesota (State ID: 27)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 87 counties from Minnesota
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Mississippi (State ID: 28)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 82 counties from Mississippi
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Missouri (State ID: 29)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 115 counties from Missouri
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Montana (State ID: 30)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 56 counties from Montana
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Nebraska (State ID: 31)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 93 counties from Nebraska
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Nevada (State ID: 32)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 17 counties from Nevada
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in New Hampshire (State ID: 33)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 10 counties from New Hampshire
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in New Jersey (State ID: 34)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 21 counties from New Jersey
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in New Mexico (State ID: 35)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 33 counties from New Mexico
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in New York (State ID: 36)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 62 counties from New York
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in North Carolina (State ID: 37)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 100 counties from North Carolina
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in North Dakota (State ID: 38)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,597 - INFO -     Added 53 counties from North Dakota
2025-04-14 09:54:36,597 - INFO -   Collecting data for counties in Ohio (State ID: 39)...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,597 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 88 counties from Ohio
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Oklahoma (State ID: 40)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 77 counties from Oklahoma
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Oregon (State ID: 41)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 36 counties from Oregon
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Pennsylvania (State ID: 42)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 67 counties from Pennsylvania
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Rhode Island (State ID: 44)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 5 counties from Rhode Island
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in South Carolina (State ID: 45)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 46 counties from South Carolina
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in South Dakota (State ID: 46)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 66 counties from South Dakota
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Tennessee (State ID: 47)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 95 counties from Tennessee
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Texas (State ID: 48)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 254 counties from Texas
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Utah (State ID: 49)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 29 counties from Utah
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Vermont (State ID: 50)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 14 counties from Vermont
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Virginia (State ID: 51)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 133 counties from Virginia
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Washington (State ID: 53)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 39 counties from Washington
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in West Virginia (State ID: 54)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 55 counties from West Virginia
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Wisconsin (State ID: 55)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 72 counties from Wisconsin
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Wyoming (State ID: 56)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,598 - INFO -     Added 23 counties from Wyoming
2025-04-14 09:54:36,598 - INFO -   Collecting data for counties in Puerto Rico (State ID: 72)...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 1/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 2/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 3/4...
2025-04-14 09:54:36,598 - INFO -     Fetching chunk 4/4...
2025-04-14 09:54:36,599 - INFO -     Added 78 counties from Puerto Rico
2025-04-14 09:54:36,599 - INFO -   Data saved to census_acs_data/census_acs_county_data_2023_20250414_095434.csv
2025-04-14 09:54:36,599 - INFO -   Collected data for 3222 counties with 36 variables
2025-04-14 09:54:36,599 - INFO -   Looking up Core Based Statistical Areas (CBSAs)...
2025-04-14 09:54:36,599 - INFO -   Trying CBSA format: https://api.census.gov/data/2023/acs/acs5?get=NAME&for=metropolitan%20statistical%20area:*&in=state:10&key=5721c8c54e15cb904a4b6cda8ad6c18b9afdcc34
2025-04-14 09:54:36,599 - INFO -     Format not working: error: unknown/unsupported geography hierarchy
2025-04-14 09:54:36,599 - INFO -   Trying CBSA format: https://api.census.gov/data/2023/acs/acs5?get=NAME&for=metropolitan%20statistical%20area/micropolitan%20statistical%20area:*&in=state:10&key=5721c8c54e15cb904a4b6cda8ad6c18b9afdcc34
2025-04-14 09:54:36,599 - INFO -     Format not working: error: unknown/unsupported geography hierarchy
2025-04-14 09:54:36,599 - INFO -   Trying CBSA format: https://api.census.gov/data/2023/acs/acs5?get=NAME&for=cbsa:*&in=state:10&key=5721c8c54e15cb904a4b6cda8ad6c18b9afdcc34
2025-04-14 09:54:36,599 - INFO -     Format not working: error: unknown/unsupported geography hierarchy
2025-04-14 09:54:36,599 - INFO -   Trying CBSA format: https://api.census.gov/data/2023/acs/acs5?get=NAME&for=combined%20statistical%20area:*&in=state:10&key=5721c8c54e15cb904a4b6cda8ad6c18b9afdcc34
2025-04-14 09:54:36,599 - INFO -     Format not working: error: unknown/unsupported geography hierarchy
2025-04-14 09:54:36,599 - INFO -   Trying CBSA format: https://api.census.gov/data/2023/acs/acs5?get=NAME&for=core%20based%20statistical%20area:*&in=state:10&key=5721c8c54e15cb904a4b6cda8ad6c18b9afdcc34
2025-04-14 09:54:36,599 - INFO -     Format not working: error: unknown/unsupported geography hierarchy
2025-04-14 09:54:36,599 - INFO -   Could not find a working CBSA parameter format. Using county data only.
2025-04-14 09:54:36,599 - INFO -   Data dictionary saved to census_acs_data/census_acs_data_dictionary_20250414_095436.csv
2025-04-14 09:54:36,599 - INFO -   
2025-04-14 09:54:36,599 - INFO -   Sample of ACS data:
2025-04-14 09:54:36,599 - INFO -                         NAME B01001_001E  ... B25095_001E  year
2025-04-14 09:54:36,599 - INFO -   0  Autauga County, Alabama       59285  ...       16872  2023
2025-04-14 09:54:36,599 - INFO -   1  Baldwin County, Alabama      239945  ...       73381  2023
2025-04-14 09:54:36,599 - INFO -   2  Barbour County, Alabama       24757  ...        6128  2023
2025-04-14 09:54:36,599 - INFO -   3     Bibb County, Alabama       22152  ...        5843  2023
2025-04-14 09:54:36,599 - INFO -   4   Blount County, Alabama       59292  ...       17473  2023
2025-04-14 09:54:36,599 - INFO -   
2025-04-14 09:54:36,599 - INFO -   [5 rows x 36 columns]
2025-04-14 09:54:36,599 - INFO - Completed: Census ACS data collection
2025-04-14 09:54:36,599 - INFO - Starting: IRS SOI data collection
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:54:37,115 - INFO - Starting IRS SOI data collection
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:54:37,115 - INFO - Created directory: irs_soi_data
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:54:37,290 - INFO - Found data for these years: ['2022', '2021', '2020', '2019', '2018']
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:54:37,291 - INFO - Created directory: irs_soi_data/tax_year_2022
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:54:37,291 - INFO - Processing data for tax year 2022
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:03,137 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/zipcode2022.zip to irs_soi_data/tax_year_2022/irs_soi_zipcode_2022_all.zip
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:04,120 - INFO - Extracted irs_soi_data/tax_year_2022/irs_soi_zipcode_2022_all.zip to irs_soi_data/tax_year_2022
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:04,266 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/22zpdoc.docx to irs_soi_data/tax_year_2022/irs_soi_zipcode_2022_documentation.docx
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:04,555 - INFO - Parsed CSV data from irs_soi_data/tax_year_2022/22zpallnoagi.csv, shape: (27690, 166)
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:05,492 - INFO - Saved processed data to irs_soi_data/tax_year_2022/irs_soi_zipcode_2022_processed.csv
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:05,492 - INFO - Created directory: irs_soi_data/tax_year_2021
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:05,492 - INFO - Processing data for tax year 2021
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:33,190 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/zipcode2021.zip to irs_soi_data/tax_year_2021/irs_soi_zipcode_2021_all.zip
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:34,202 - INFO - Extracted irs_soi_data/tax_year_2021/irs_soi_zipcode_2021_all.zip to irs_soi_data/tax_year_2021
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:34,369 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/21zpdoc.docx to irs_soi_data/tax_year_2021/irs_soi_zipcode_2021_documentation.docx
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:37,120 - INFO - Parsed CSV data from irs_soi_data/tax_year_2021/21zpallagi.csv, shape: (166221, 168)
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:42,347 - INFO - Saved processed data to irs_soi_data/tax_year_2021/irs_soi_zipcode_2021_processed.csv
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:42,347 - INFO - Created directory: irs_soi_data/tax_year_2020
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:55:42,348 - INFO - Processing data for tax year 2020
2025-04-14 09:57:46,301 - WARNING -   2025-04-14 09:56:11,925 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/zipcode2020.zip to irs_soi_data/tax_year_2020/irs_soi_zipcode_2020_all.zip
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:12,958 - INFO - Extracted irs_soi_data/tax_year_2020/irs_soi_zipcode_2020_all.zip to irs_soi_data/tax_year_2020
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:13,141 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/20zpdoc.docx to irs_soi_data/tax_year_2020/irs_soi_zipcode_2020_documentation.docx
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:15,834 - INFO - Parsed CSV data from irs_soi_data/tax_year_2020/20zpallagi.csv, shape: (166452, 166)
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:21,040 - INFO - Saved processed data to irs_soi_data/tax_year_2020/irs_soi_zipcode_2020_processed.csv
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:21,040 - INFO - Created directory: irs_soi_data/tax_year_2019
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:21,040 - INFO - Processing data for tax year 2019
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:50,790 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/zipcode2019.zip to irs_soi_data/tax_year_2019/irs_soi_zipcode_2019_all.zip
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:51,723 - INFO - Extracted irs_soi_data/tax_year_2019/irs_soi_zipcode_2019_all.zip to irs_soi_data/tax_year_2019
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:51,999 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/19zpdoc.docx to irs_soi_data/tax_year_2019/irs_soi_zipcode_2019_documentation.docx
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:52,316 - INFO - Parsed CSV data from irs_soi_data/tax_year_2019/19zpallnoagi.csv, shape: (27695, 153)
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:53,257 - INFO - Saved processed data to irs_soi_data/tax_year_2019/irs_soi_zipcode_2019_processed.csv
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:53,258 - INFO - Created directory: irs_soi_data/tax_year_2018
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:56:53,258 - INFO - Processing data for tax year 2018
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:16,031 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/zipcode2018.zip to irs_soi_data/tax_year_2018/irs_soi_zipcode_2018_all.zip
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:17,123 - INFO - Extracted irs_soi_data/tax_year_2018/irs_soi_zipcode_2018_all.zip to irs_soi_data/tax_year_2018
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:17,272 - INFO - Downloaded https://www.irs.gov/pub/irs-soi/18zpdoc.docx to irs_soi_data/tax_year_2018/irs_soi_zipcode_2018_documentation.docx
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:19,819 - INFO - Parsed CSV data from irs_soi_data/tax_year_2018/18zpallagi.csv, shape: (165935, 154)
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:24,992 - INFO - Saved processed data to irs_soi_data/tax_year_2018/irs_soi_zipcode_2018_processed.csv
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:46,221 - INFO - Saved combined data from all years to irs_soi_data/irs_soi_zipcode_all_years.csv
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:46,222 - INFO - Saved data dictionary to irs_soi_data/irs_soi_data_dictionary.json
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:46,222 - INFO - Saved README to irs_soi_data/README.md
2025-04-14 09:57:46,302 - WARNING -   2025-04-14 09:57:46,222 - INFO - IRS SOI data collection completed in 189.11 seconds
2025-04-14 09:57:46,302 - INFO - Completed: IRS SOI data collection
2025-04-14 09:57:46,302 - INFO - Starting: FDIC deposit data collection
2025-04-14 09:59:17,950 - WARNING -   2025-04-14 09:57:46,707 - fdic_data_collector - INFO - Starting FDIC Summary of Deposits data collection
2025-04-14 09:59:17,950 - WARNING -   2025-04-14 09:57:46,707 - fdic_data_collector - INFO - Creating data dictionary...
2025-04-14 09:59:17,950 - WARNING -   2025-04-14 09:57:46,707 - fdic_data_collector - INFO - Data dictionary created at fdic_deposit_data/fdic_sod_data_dictionary.csv
2025-04-14 09:59:17,950 - WARNING -   2025-04-14 09:57:46,707 - fdic_data_collector - INFO - 
2025-04-14 09:59:17,950 - WARNING -   Processing data for year 2020
2025-04-14 09:59:17,950 - WARNING -   2025-04-14 09:57:46,707 - fdic_data_collector - INFO - Fetching complete SOD data for year 2020 via API...
2025-04-14 09:59:17,950 - WARNING -   
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 0 records [00:00, ? records/s]
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 10000 records [00:02, 4678.45 records/s]
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 20000 records [00:04, 5005.77 records/s]
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 30000 records [00:06, 4976.86 records/s]
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 40000 records [00:08, 5017.83 records/s]
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 50000 records [00:10, 4926.06 records/s]
2025-04-14 09:59:17,950 - WARNING -   Fetching 2020 data: 60000 records [00:12, 5033.44 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2020 data: 70000 records [00:14, 5042.24 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2020 data: 80000 records [00:16, 4962.51 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2020 data: 84982 records [00:17, 4578.58 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2020 data: 84982 records [00:17, 4843.42 records/s]
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:04,289 - fdic_data_collector - INFO - Successfully retrieved 84982 records for 2020 via API.
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:05,992 - fdic_data_collector - INFO - Saved 84982 records to fdic_deposit_data/sod_data_2020.csv
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:05,992 - fdic_data_collector - INFO - 
2025-04-14 09:59:17,951 - WARNING -   Processing data for year 2021
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:05,993 - fdic_data_collector - INFO - Fetching complete SOD data for year 2021 via API...
2025-04-14 09:59:17,951 - WARNING -   
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 0 records [00:00, ? records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 10000 records [00:01, 5177.65 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 20000 records [00:04, 4965.77 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 30000 records [00:06, 4930.90 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 40000 records [00:08, 4885.65 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 50000 records [00:10, 4937.59 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 60000 records [00:12, 5011.78 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 70000 records [00:14, 4790.15 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 80000 records [00:16, 4914.70 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 81791 records [00:17, 4329.26 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2021 data: 81791 records [00:17, 4737.23 records/s]
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:23,285 - fdic_data_collector - INFO - Successfully retrieved 81791 records for 2021 via API.
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:24,855 - fdic_data_collector - INFO - Saved 81791 records to fdic_deposit_data/sod_data_2021.csv
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:24,855 - fdic_data_collector - INFO - 
2025-04-14 09:59:17,951 - WARNING -   Processing data for year 2022
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:24,855 - fdic_data_collector - INFO - Fetching complete SOD data for year 2022 via API...
2025-04-14 09:59:17,951 - WARNING -   
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 0 records [00:00, ? records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 10000 records [00:01, 5001.53 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 20000 records [00:04, 4916.80 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 30000 records [00:06, 4899.74 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 40000 records [00:08, 4943.69 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 50000 records [00:10, 4946.07 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 60000 records [00:12, 4908.70 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 70000 records [00:14, 4862.10 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 79172 records [00:16, 4878.19 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2022 data: 79172 records [00:16, 4901.82 records/s]
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:41,034 - fdic_data_collector - INFO - Successfully retrieved 79172 records for 2022 via API.
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:42,560 - fdic_data_collector - INFO - Saved 79172 records to fdic_deposit_data/sod_data_2022.csv
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:42,560 - fdic_data_collector - INFO - 
2025-04-14 09:59:17,951 - WARNING -   Processing data for year 2023
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:42,560 - fdic_data_collector - INFO - Fetching complete SOD data for year 2023 via API...
2025-04-14 09:59:17,951 - WARNING -   
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 0 records [00:00, ? records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 10000 records [00:02, 4678.19 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 20000 records [00:04, 4845.62 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 30000 records [00:06, 4978.33 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 40000 records [00:08, 4997.18 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 50000 records [00:10, 4956.07 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 60000 records [00:12, 4712.47 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 70000 records [00:14, 4858.99 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 77770 records [00:16, 4624.23 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2023 data: 77770 records [00:16, 4775.71 records/s]
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:58:58,900 - fdic_data_collector - INFO - Successfully retrieved 77770 records for 2023 via API.
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:59:00,455 - fdic_data_collector - INFO - Saved 77770 records to fdic_deposit_data/sod_data_2023.csv
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:59:00,455 - fdic_data_collector - INFO - 
2025-04-14 09:59:17,951 - WARNING -   Processing data for year 2024
2025-04-14 09:59:17,951 - WARNING -   2025-04-14 09:59:00,455 - fdic_data_collector - INFO - Fetching complete SOD data for year 2024 via API...
2025-04-14 09:59:17,951 - WARNING -   
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 0 records [00:00, ? records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 10000 records [00:01, 5146.52 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 20000 records [00:03, 5106.75 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 30000 records [00:05, 5142.69 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 40000 records [00:07, 5164.45 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 50000 records [00:09, 5118.90 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 60000 records [00:11, 4931.04 records/s]
2025-04-14 09:59:17,951 - WARNING -   Fetching 2024 data: 70000 records [00:13, 4993.44 records/s]
2025-04-14 09:59:17,952 - WARNING -   Fetching 2024 data: 76742 records [00:15, 4710.87 records/s]
2025-04-14 09:59:17,952 - WARNING -   Fetching 2024 data: 76742 records [00:15, 4932.21 records/s]
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:16,040 - fdic_data_collector - INFO - Successfully retrieved 76742 records for 2024 via API.
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,867 - fdic_data_collector - INFO - Saved 76742 records to fdic_deposit_data/sod_data_2024.csv
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,870 - fdic_data_collector - INFO - Found 2 new fields not in data dictionary: data, score
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,870 - fdic_data_collector - INFO - Updated data dictionary with new fields (placeholder descriptions)
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,870 - fdic_data_collector - INFO - 
2025-04-14 09:59:17,952 - WARNING -   FDIC Summary of Deposits data collection complete.
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,870 - fdic_data_collector - INFO - Successfully downloaded data for 5 out of 5 years.
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,870 - fdic_data_collector - INFO - Data files are stored in the fdic_deposit_data directory.
2025-04-14 09:59:17,952 - WARNING -   2025-04-14 09:59:17,870 - fdic_data_collector - INFO - Data dictionary is available at fdic_deposit_data/fdic_sod_data_dictionary.csv
2025-04-14 09:59:17,952 - INFO - Completed: FDIC deposit data collection
2025-04-14 09:59:17,952 - INFO - Starting: BLS advisors data collection
2025-04-14 10:02:02,432 - INFO -   CHROME >= 115, using mac-arm64 as architecture identifier
2025-04-14 10:02:02,433 - INFO -   Detecting available years from BLS OEWS page...
2025-04-14 10:02:02,433 - INFO -   Detected available years: [2024, 2023, 2022, 2021, 2020]
2025-04-14 10:02:02,433 - INFO -   Downloading ZIP for 2020...
2025-04-14 10:02:02,433 - INFO -   Found ZIP link: https://www.bls.gov/oes/special-requests/oesm20ma.zip
2025-04-14 10:02:02,433 - INFO -   Waiting for download to complete...
2025-04-14 10:02:02,433 - INFO -   Downloaded: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/bls_advisors_data/oesm20ma.zip
2025-04-14 10:02:02,433 - INFO -   Contents of ZIP oesm20ma.zip: ['oesm20ma/BOS_M2020_dl.xlsx', 'oesm20ma/file_descriptions.xlsx', 'oesm20ma/MSA_M2020_dl.xlsx']
2025-04-14 10:02:02,433 - INFO -   Saved filtered data for 2020 to bls_advisors_data/2020.csv
2025-04-14 10:02:02,433 - INFO -   Downloading ZIP for 2021...
2025-04-14 10:02:02,433 - INFO -   Found ZIP link: https://www.bls.gov/oes/special-requests/oesm21ma.zip
2025-04-14 10:02:02,433 - INFO -   Waiting for download to complete...
2025-04-14 10:02:02,433 - INFO -   Downloaded: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/bls_advisors_data/oesm21ma.zip
2025-04-14 10:02:02,433 - INFO -   Contents of ZIP oesm21ma.zip: ['oesm21ma/BOS_M2021_dl.xlsx', 'oesm21ma/file_descriptions.xlsx', 'oesm21ma/MSA_M2021_dl.xlsx']
2025-04-14 10:02:02,433 - INFO -   Saved filtered data for 2021 to bls_advisors_data/2021.csv
2025-04-14 10:02:02,433 - INFO -   Downloading ZIP for 2022...
2025-04-14 10:02:02,433 - INFO -   Found ZIP link: https://www.bls.gov/oes/special-requests/oesm22ma.zip
2025-04-14 10:02:02,433 - INFO -   Waiting for download to complete...
2025-04-14 10:02:02,433 - INFO -   Downloaded: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/bls_advisors_data/oesm22ma.zip
2025-04-14 10:02:02,433 - INFO -   Contents of ZIP oesm22ma.zip: ['oesm22ma/~$file_descriptions.xlsx', 'oesm22ma/~$MSA_M2022_dl.xlsx', 'oesm22ma/BOS_M2022_dl.xlsx', 'oesm22ma/file_descriptions.xlsx', 'oesm22ma/MSA_M2022_dl.xlsx']
2025-04-14 10:02:02,433 - INFO -   Saved filtered data for 2022 to bls_advisors_data/2022.csv
2025-04-14 10:02:02,433 - INFO -   Downloading ZIP for 2023...
2025-04-14 10:02:02,433 - INFO -   Found ZIP link: https://www.bls.gov/oes/special-requests/oesm23ma.zip
2025-04-14 10:02:02,433 - INFO -   Waiting for download to complete...
2025-04-14 10:02:02,433 - INFO -   Downloaded: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/bls_advisors_data/oesm23ma.zip
2025-04-14 10:02:02,433 - INFO -   Contents of ZIP oesm23ma.zip: ['oesm23ma/BOS_M2023_dl.xlsx', 'oesm23ma/file_descriptions.xlsx', 'oesm23ma/MSA_M2023_dl.xlsx']
2025-04-14 10:02:02,433 - INFO -   Saved filtered data for 2023 to bls_advisors_data/2023.csv
2025-04-14 10:02:02,433 - INFO -   Downloading ZIP for 2024...
2025-04-14 10:02:02,433 - INFO -   Found ZIP link: https://www.bls.gov/oes/special-requests/oesm24ma.zip
2025-04-14 10:02:02,433 - INFO -   Waiting for download to complete...
2025-04-14 10:02:02,433 - INFO -   Downloaded: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/bls_advisors_data/oesm24ma.zip
2025-04-14 10:02:02,433 - INFO -   Contents of ZIP oesm24ma.zip: ['oesm24ma/', 'oesm24ma/BOS_M2024_dl.xlsx', 'oesm24ma/file_descriptions.xlsx', 'oesm24ma/MSA_M2024_dl.xlsx']
2025-04-14 10:02:02,433 - INFO -   Saved filtered data for 2024 to bls_advisors_data/2024.csv
2025-04-14 10:02:02,433 - INFO -   Generated data dictionary at bls_advisors_data/data_dictionary.json
2025-04-14 10:02:02,433 - INFO -   All done.
2025-04-14 10:02:02,433 - INFO - Completed: BLS advisors data collection
2025-04-14 10:02:02,433 - INFO - Starting: County-to-MSA crosswalk creation
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:02,934 - INFO - Downloading https://www2.census.gov/geo/tiger/TIGER2023/CBSA/tl_2023_us_cbsa.zip...
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:06,993 - INFO - Downloaded successfully to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/cbsa_tiger_20250414.zip
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:06,995 - INFO - Downloading https://www2.census.gov/geo/tiger/TIGER2023/COUNTY/tl_2023_us_county.zip...
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:15,949 - INFO - Downloaded successfully to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/county_tiger_20250414.zip
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:15,963 - INFO - Processing CBSA data from TIGER/Line shapefile
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:15,964 - INFO - Found DBF file: tl_2023_us_cbsa.dbf
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,331 - INFO - Loaded 935 rows from tl_2023_us_cbsa.shp using GeoPandas
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,335 - INFO - Processed CBSA data with 393 Metropolitan Statistical Areas
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,344 - INFO - Processing county data from TIGER/Line shapefile
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,344 - INFO - Found DBF file: tl_2023_us_county.dbf
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,974 - INFO - Loaded 3235 rows from tl_2023_us_county.shp using GeoPandas
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,993 - INFO - Processed county data with 3235 counties
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,993 - INFO - Getting CBSA-to-county relationships from Census API
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,993 - WARNING - Census API key required - replace 'YOUR_API_KEY' with your actual API key
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,993 - INFO - Attempting to create relationships from downloaded TIGER/Line files
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,994 - INFO - Creating placeholder relationship table
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,994 - INFO - Created placeholder relationship table with 5 rows
2025-04-14 10:02:17,065 - WARNING -   2025-04-14 10:02:16,997 - INFO - Created metro counties DataFrame with 5 rows
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:16,997 - INFO - Creating additional mappings...
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:16,999 - INFO - Successfully created additional mappings
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:17,004 - INFO - Saved CBSA information to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/cbsa_info_20250414.csv
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:17,005 - INFO - Saved metro counties to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/metro_counties_20250414.csv
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:17,005 - INFO - Saved CBSA mappings to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/cbsa_mappings_20250414.json
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:17,005 - INFO - Saved combined crosswalk data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/cbsa_crosswalk_data_20250414.pkl
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:17,005 - INFO - Created README file at /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/README.md
2025-04-14 10:02:17,066 - WARNING -   2025-04-14 10:02:17,005 - INFO - CBSA crosswalk processing complete!
2025-04-14 10:02:17,066 - INFO - Completed: County-to-MSA crosswalk creation
2025-04-14 10:02:17,066 - INFO - Found 1 files matching cbsa_crosswalk_data_*.pkl in /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks
2025-04-14 10:02:17,066 - INFO - Starting: County-to-MSA data aggregation
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,543 - INFO - Starting county-to-MSA aggregation process...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,544 - INFO - Loading CBSA crosswalk data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,544 - INFO - Using crosswalk file: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/crosswalks/cbsa_crosswalk_data_20250414.pkl
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,544 - INFO - Loaded crosswalk data with 393 CBSAs and 5 counties
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,544 - INFO - Loading BEA data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,545 - INFO - Loading GDP data from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bea_data/county_gdp_2023_2024_A.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,550 - INFO - Loading Personal Income data from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bea_data/county_personal_income_2023_2024_A.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,555 - INFO - Loading Population data from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bea_data/county_population_2023_2024_A.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,558 - INFO - Loading Per Capita Income data from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bea_data/county_per_capita_income_2023_2024_A.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,562 - INFO - Loaded BEA data: gdp, personal_income, population, per_capita_income
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,562 - INFO - Loading Census ACS data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,563 - INFO - Loading Census ACS data from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../census_acs_data/census_acs_county_data_2023_20250407_083613.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,571 - INFO - Loaded Census ACS data with 3222 counties
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,572 - INFO - Loaded Census ACS data dictionary with 32 variables
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,572 - INFO - Loading IRS SOI data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:17,573 - INFO - Loading combined IRS SOI data from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../irs_soi_data/irs_soi_zipcode_all_years.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:21,158 - INFO - Loaded IRS SOI data dictionary with 39 fields
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:21,159 - INFO - Loaded IRS SOI data for 1 datasets
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:21,159 - INFO - Loading FDIC deposit data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:21,159 - INFO - Loading FDIC deposit data for 2020 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../fdic_deposit_data/sod_data_2020.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:21,872 - INFO - Loading FDIC deposit data for 2021 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../fdic_deposit_data/sod_data_2021.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:22,560 - INFO - Loading FDIC deposit data for 2022 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../fdic_deposit_data/sod_data_2022.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:23,306 - INFO - Loading FDIC deposit data for 2023 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../fdic_deposit_data/sod_data_2023.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,011 - INFO - Loading FDIC deposit data for 2024 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../fdic_deposit_data/sod_data_2024.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,699 - INFO - Loaded FDIC data dictionary with 38 fields
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,699 - INFO - Loaded FDIC deposit data for 0 years
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,709 - INFO - Loading BLS advisor data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,709 - INFO - Loading BLS advisor data for 2020 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2020.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,713 - INFO - Loading BLS advisor data for 2021 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2021.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,716 - INFO - Loading BLS advisor data for 2022 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2022.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,718 - INFO - Loading BLS advisor data for 2023 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2023.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,720 - INFO - Loading BLS advisor data for 2024 from: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2024.csv
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,722 - INFO - Loaded BLS advisor data dictionary
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,722 - INFO - Loaded BLS advisor data for 5 years
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,722 - INFO - Aggregating BEA data to MSA level...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,722 - INFO - Aggregating GDP data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,728 - INFO - Aggregating Population data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,730 - INFO - Aggregating Personal Income data...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,733 - INFO - BEA data aggregation complete. Created 5 MSA-level datasets.
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,733 - INFO - Aggregating Census ACS data to MSA level...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,741 - INFO - Census ACS data aggregation complete with 5 MSAs
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:24,741 - INFO - Aggregating IRS SOI data to MSA level...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:25,035 - WARNING - ZIP code to MSA mapping is approximated and needs improvement in production
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:25,058 - INFO - Created placeholder IRS data at MSA level (requires ZIP-to-county mapping)
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:25,073 - INFO - Aggregating FDIC deposit data to MSA level...
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:25,073 - WARNING - No FDIC deposit data available for aggregation.
2025-04-14 10:02:25,136 - WARNING -   2025-04-14 10:02:25,073 - INFO - Combining MSA-level data from all sources...
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,074 - INFO - Created MSA reference table with 5 MSAs
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,077 - INFO - Created combined metrics table with 5 MSAs and 8 columns
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,077 - INFO - Saving output files...
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,079 - INFO - Saved combined metrics to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_combined_metrics_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,079 - INFO - Saved MSA reference to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_reference_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,080 - INFO - Saved BEA gdp data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_bea_gdp_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,080 - INFO - Saved BEA gdp_growth data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_bea_gdp_growth_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,081 - INFO - Saved BEA population data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_bea_population_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,081 - INFO - Saved BEA personal_income data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_bea_personal_income_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,081 - INFO - Saved BEA per_capita_income_calculated data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_bea_per_capita_income_calculated_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,082 - INFO - Saved Census acs data to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_census_acs_20250414.csv
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,082 - INFO - Created README file at /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/README.md
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,082 - INFO - All output files saved successfully
2025-04-14 10:02:25,137 - WARNING -   2025-04-14 10:02:25,082 - INFO - County-to-MSA aggregation process complete!
2025-04-14 10:02:25,137 - INFO - Completed: County-to-MSA data aggregation
2025-04-14 10:02:25,137 - INFO - Found 1 files matching msa_combined_metrics_*.csv in /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata
2025-04-14 10:02:25,137 - INFO - Starting: HNWI density metrics calculation
2025-04-14 10:02:25,514 - WARNING -   2025-04-14 10:02:25,477 - INFO - Starting HNWI density metrics calculation...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,477 - INFO - Loading MSA-level data...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,478 - INFO - Loading combined metrics from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_combined_metrics_20250414.csv
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,480 - INFO - Loading BEA GDP data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_bea_gdp_growth_20250414.csv
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,480 - INFO - Loading Census ACS data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_census_acs_20250414.csv
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,481 - INFO - Loaded MSA data: combined, gdp, acs
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,481 - INFO - Calculating HNWI Density Index...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,482 - INFO - Calculated HNWI Density Index using 3 indicators
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,482 - INFO - Calculating Wealth Growth Rate...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - ERROR - Error calculating Wealth Growth Rate: "None of [Index(['cbsa_code', 'gdp_cagr', 'years_measured'], dtype='object')] are in the [columns]"
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - INFO - Calculating Luxury Real Estate Quotient...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - INFO - Using pre-calculated Luxury Real Estate Quotient
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - INFO - Calculating Income Elite Ratio...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - INFO - Using pre-calculated Income Elite Ratio
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - INFO - Calculating Banking Deposit Intensity...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - WARNING - No suitable data available to calculate Banking Deposit Intensity
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,484 - INFO - Creating HNWI density rankings...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,486 - INFO - Created HNWI density rankings using 2 metrics
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,486 - INFO - Saving results...
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,486 - INFO - Saved complete metrics to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/hnwi_density_metrics_20250414.csv
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,487 - INFO - Saved rankings to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/hnwi_density_rankings_20250414.csv
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,487 - INFO - Created documentation file at /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/hnwi_density_metrics_documentation.md
2025-04-14 10:02:25,515 - WARNING -   2025-04-14 10:02:25,487 - INFO - HNWI density metrics calculation complete!
2025-04-14 10:02:25,515 - INFO - Completed: HNWI density metrics calculation
2025-04-14 10:02:25,515 - INFO - Starting: Financial services coverage metrics calculation
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,820 - INFO - Starting financial services coverage metrics calculation...
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,820 - INFO - Loading MSA-level data...
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,820 - INFO - Loading combined metrics from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_combined_metrics_20250414.csv
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,822 - INFO - Loading BLS 2024 data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2024.csv
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,824 - INFO - Loading BLS 2023 data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2023.csv
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,826 - INFO - Loading BLS 2022 data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2022.csv
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,828 - INFO - Loading BLS 2021 data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2021.csv
2025-04-14 10:02:25,865 - WARNING -   2025-04-14 10:02:25,829 - INFO - Loading BLS 2020 data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/../bls_advisors_data/2020.csv
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,830 - INFO - Loading MSA reference data from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/msadata/msa_reference_20250414.csv
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - INFO - Loaded MSA data: combined, bls_2024, bls_2023, bls_2022, bls_2021, bls_2020, reference
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - INFO - Checking for HNWI density metrics...
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - INFO - Loading HNWI metrics from /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/hnwi_density_metrics_20250414.csv
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - INFO - Using HNWI metrics as base for calculations
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - INFO - Calculating Advisor Penetration Rate...
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - WARNING - BLS data doesn't have CBSA code column
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - WARNING - Unable to calculate Advisor Penetration Rate
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,831 - INFO - Calculating HNWI-to-Advisor Ratio...
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,832 - WARNING - Missing required columns for HNWI-to-Advisor Ratio: ['total_households', 'total_advisors']
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,832 - INFO - Estimating market opportunity...
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,833 - INFO - Calculated opportunity scores using 1 metrics
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,833 - INFO - Creating financial services coverage rankings...
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,834 - INFO - Created coverage rankings using 1 metrics
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,834 - INFO - Saving results...
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,835 - INFO - Saved complete metrics to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/financial_services_metrics_20250414.csv
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,836 - INFO - Saved rankings to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/coverage_opportunity_rankings_20250414.csv
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,837 - INFO - Saved top market opportunities to /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/top_market_opportunities_20250414.csv
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,837 - INFO - Created documentation file at /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/financial_services_metrics_documentation.md
2025-04-14 10:02:25,866 - WARNING -   2025-04-14 10:02:25,837 - INFO - Financial services coverage metrics calculation complete!
2025-04-14 10:02:25,866 - INFO - Completed: Financial services coverage metrics calculation
2025-04-14 10:02:25,866 - INFO - Starting: Economic vitality metrics calculation
2025-04-14 10:02:25,880 - WARNING -     File "/Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/metrics/economic_vitality_metrics.py", line 255
2025-04-14 10:02:25,880 - WARNING -       '2012': 'Proprietors' income',  # Business owners
2025-04-14 10:02:25,880 - WARNING -                                   ^
2025-04-14 10:02:25,880 - WARNING -   SyntaxError: unterminated string literal (detected at line 255)
2025-04-14 10:02:25,880 - ERROR - Failed: Economic vitality metrics calculation (Return code: 1)
2025-04-14 10:02:25,880 - WARNING - Failed to calculate economic vitality metrics.
2025-04-14 10:02:25,880 - INFO - Creating Phase 1 summary report...
2025-04-14 10:02:25,881 - INFO - Created Phase 1 summary report at /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/phase1_summary_20250414.md
2025-04-14 10:02:25,881 - INFO - Phase 1 summary report available at: /Users/sandeepmangaraj/myworkspace/Utilities/wmmo/wmmo_analytics/phase1_summary_20250414.md
2025-04-14 10:02:25,881 - INFO - Phase 1 of Wealth Management Market Opportunity Analysis complete!
